@startuml sequense diagram
mainframe Test normal day

participant "psm:PSM" as psm
participant "pim:PIM" as pim
participant "enerty_saver:ES" as es
participant "test:Test" as test

'Set preferred temp
es <- test: set_temperature(prefered_temp{23})
pim <- es: set_temperature(prefered_temp{23})

psm <- test: add_light_sensor(1, "")

psm <- pim: add_thermometer(1, "")
psm <- pim: add_device(didid1, didtxt1)

pim -> test: prompt("Now entering thermostat")

hnote across: day and light on
'setup compleat

psm <- test: temperature(1, "", 15)
psm -> test: switch_on(1)

hnote across: some time later 1
psm <- test: temperature(1, "", 25)
psm -> test: switch_off(1)

hnote across: lights off
psm <- test: temperature(1, "", 15)
es <- test: luminence(1, 100)
psm <- es: set_temperature(prefered_temp{23} - temp_diff{2})
psm -> test: switch_on(1)

hnote across: some time later 2
psm <- test: temperature(1, "", 20)
psm -> test: switch_off(1)

hnote across: night starts
es <- test: timer.start(delay{0}) ?
psm <- test: temperature(1, "", 10)
psm <- es: set_temperature(prefered_temp{23} - temp_night_diff{8})
psm -> test: switch_on(1)

hnote across: some time later 3
psm <- test: temperature(1, "", 14)
psm -> test: switch_off(1)

hnote across: day start
es <- test: timer.cancel() ?
psm <- es: set_temperature(prefered_temp{23})
psm -> test: switch_on(1)



@enduml
