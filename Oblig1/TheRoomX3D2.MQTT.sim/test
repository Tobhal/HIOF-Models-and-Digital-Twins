@startuml
mainframe sd SimpleThermostat

participant "MQTT" as mq
participant "psm:PSM" as psm
participant "pim:PIM" as pim

actor "human" as h

h -> pim : set_temperature(temp1)
pim-> psm: add_thermometer(id1, txt1)
pim-> psm: add_device(id1, txt1)
pim ->] : prompt("Now entering thermostat")
loop
mq-> psm: temperature(id1, txt1, temp2)
psm -> pim: temperature(id1, txt1, temp2)
alt
|||
else temp2<temp1-1
pim -> mq: SwitchOn(id1)
else temp2>=temp1+1
pim -> mq: SwitchOff(id1)
end
mq -> pim: (luminance_change(id1, txt, lightval))
end
mq <-h: SwitchOn(did1)
mq <-h: SwitchOff(did1)
@enduml